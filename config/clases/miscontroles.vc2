*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="miscontroles.vcx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS btn AS cntbs OF "base.vcx" 
 	*< CLASSDATA: Baseclass="container" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Imgbs1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Imgbs2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Imgbs3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lblapli1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="btn1" UniqueID="" Timestamp="" />

	BackStyle = 0
	BorderWidth = 0
	Height = 36
	Name = "btn"
	Width = 132

	ADD OBJECT 'btn1' AS cmdbs WITH ;
		Height = 25, ;
		Left = 13, ;
		Name = "btn1", ;
		Style = 1, ;
		Top = 4, ;
		Width = 109, ;
		ZOrderSet = 4
		*< END OBJECT: ClassLib="base.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Imgbs1' AS imgbs WITH ;
		Height = 35, ;
		Left = 1, ;
		Name = "Imgbs1", ;
		Picture = ..\img\btn1.png, ;
		Stretch = 0, ;
		Top = 1, ;
		Width = 16, ;
		ZOrderSet = 0
		*< END OBJECT: ClassLib="base.vcx" BaseClass="image" />

	ADD OBJECT 'Imgbs2' AS imgbs WITH ;
		Height = 35, ;
		Left = 13, ;
		Name = "Imgbs2", ;
		Picture = ..\img\btn2.png, ;
		Stretch = 2, ;
		Top = 1, ;
		Width = 108, ;
		ZOrderSet = 1
		*< END OBJECT: ClassLib="base.vcx" BaseClass="image" />

	ADD OBJECT 'Imgbs3' AS imgbs WITH ;
		Height = 35, ;
		Left = 121, ;
		Name = "Imgbs3", ;
		Picture = ..\img\btn3.png, ;
		Stretch = 0, ;
		Top = 1, ;
		Width = 12, ;
		ZOrderSet = 2
		*< END OBJECT: ClassLib="base.vcx" BaseClass="image" />

	ADD OBJECT 'Lblapli1' AS lblapli WITH ;
		Left = 49, ;
		Name = "Lblapli1", ;
		Top = 13, ;
		ZOrderSet = 3
		*< END OBJECT: ClassLib="o:\2015\chukisoft\sistemabahia_vfp\vcx\aplica.vcx" BaseClass="label" />

ENDDEFINE

DEFINE CLASS btninicio AS cntbs OF "base.vcx" 
 	*< CLASSDATA: Baseclass="container" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="imgInicio" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: cargadata
	*</DefinedPropArrayMethod>

	Height = 53
	Name = "btninicio"
	Width = 136

	ADD OBJECT 'imgInicio' AS image WITH ;
		BackStyle = 0, ;
		Height = 45, ;
		Left = 6, ;
		Name = "imgInicio", ;
		Picture = ..\img\sin título-1.fw.png, ;
		Stretch = 1, ;
		Top = 4, ;
		Width = 124, ;
		ZOrderSet = 0
		*< END OBJECT: BaseClass="image" />
	
	PROCEDURE cargadata
		PARAMETERS cCursorTemp 
		 If !Type("this.objOpciones")= "O"
			This.AddObject("objOpciones", "m_opciones")
		Endif
		This.objOpciones.select_all()
		cCurOPcion = This.objOpciones.getalias()
		
		Create Cursor (cCursorTemp) (Item c(9), itemp c(9) Null , des_item c(100) , img i )
		Select (cCursorTemp)
		Index On  Item + itemp  Tag bg
		
		If Used("M_OPcion")
			Use In M_OPcion
		Endif
		If Used("d_OPcion")
			Use In d_OPcion
		Endif
		If Used("t_OPcion")
			Use In T_OPcion
		Endif
		
		Select * From (cCurOPcion) Where Isnull(Pad_Opc) And Empty(frm_Opc) Into Cursor M_OPcion
		Select * From (cCurOPcion) Where !Isnull(Pad_Opc) And Empty(frm_Opc) Into Cursor d_OPcion
		Select * From (cCurOPcion) Where !Isnull(Pad_Opc) And !Empty(frm_Opc) Into Cursor T_OPcion
		
		If Used(cCurOPcion)
			Use In (cCurOPcion)
		Endif
		
		
		Select M_OPcion
		Go Top
		Do While !Eof()
			m.item = "_"+Padl(M_OPcion.Cdg_Opc,3,'0')
			m.itemp = Null
			m.des_item = Alltrim(M_OPcion.Des_Opc)
			m.img = 5
			Insert Into (cCursorTemp) From Memvar
		
			Select M_OPcion
			Skip
		Enddo
		
		
		Select d_OPcion
		Go Top
		Do While !Eof()
			m.item = "_"+Padl(d_OPcion.Cdg_Opc,3,'0')
			m.itemp = "_"+Padl(d_OPcion.Pad_Opc,3,'0')
			m.des_item = Alltrim(d_OPcion.Des_Opc)
			m.img = 2
			Insert Into (cCursorTemp) From Memvar
		
			Select d_OPcion
			Skip
		Enddo
		
		Select T_OPcion
		Go Top
		Do While !Eof()
			m.item = "_"+Padl(T_OPcion.Cdg_Opc,3,'0')
			m.itemp = "_"+ Padl(T_OPcion.Pad_Opc,3,'0')
			m.des_item = Alltrim(T_OPcion.Des_Opc)
			m.img = 3
			Insert Into (cCursorTemp) From Memvar
		
			Select T_OPcion
			Skip
		Enddo
		
		If Used("M_OPcion")
			Use In M_OPcion
		Endif
		If Used("d_OPcion")
			Use In d_OPcion
		Endif
		If Used("t_OPcion")
			Use In t_OPcion
		Endif
	ENDPROC

	PROCEDURE Destroy
		cCurMi = This.Curtampo
		IF used(cCurMi)
			Use In (cCurMi)
		Endif
	ENDPROC

	PROCEDURE Init
		this.AddProperty("Curtampo", SYS(2015))
	ENDPROC

	PROCEDURE imgInicio.Click
		
		*!*	nForm =  _vfp.Forms.Count()
		*!*	nAbierto=0
		*!*	For nX=1 To nForm Step 1
		*!*		If _vfp.Forms.Item(nX).Name= "frminicio"
		*!*			_vfp.Forms.Item(nX).Release
		*!*			nAbierto=1
		*!*		Endif
		*!*	Endfor
		If TYPE('_vfp.Forms("frminicio")')='O'
			_vfp.Forms("frminicio").release()
		ELSE 
		
			cCurMi = This.Parent.Curtampo
			This.Parent.cargadata(cCurMi)
			Do Form frminicio With (cCurMi), _Screen.Height - (55+460), 0
		
		Endif
	ENDPROC

	PROCEDURE imgInicio.MouseLeave
		LPARAMETERS nButton, nShift, nXCoord, nYCoord
		This.parent.BackColor = RGB(240,240,240)
	ENDPROC

	PROCEDURE imgInicio.MouseMove
		LPARAMETERS nButton, nShift, nXCoord, nYCoord
		This.parent.BackColor=RGB(38,94,137)
	ENDPROC

ENDDEFINE

DEFINE CLASS caja AS cntbs OF "base.vcx" 
 	*< CLASSDATA: Baseclass="container" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Imgbs1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Imgbs2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Imgbs3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtFiltro" UniqueID="" Timestamp="" />

	BackStyle = 0
	BorderWidth = 0
	Height = 26
	Name = "caja"
	Width = 232

	ADD OBJECT 'Imgbs1' AS imgbs WITH ;
		Height = 22, ;
		Left = 1, ;
		Name = "Imgbs1", ;
		Picture = ..\img\txtbusc1.png, ;
		Top = 1, ;
		Width = 14, ;
		ZOrderSet = 0
		*< END OBJECT: ClassLib="base.vcx" BaseClass="image" />

	ADD OBJECT 'Imgbs2' AS imgbs WITH ;
		Height = 22, ;
		Left = 14, ;
		Name = "Imgbs2", ;
		Picture = ..\img\txtbusc2.png, ;
		Stretch = 2, ;
		Top = 1, ;
		Width = 215, ;
		ZOrderSet = 1
		*< END OBJECT: ClassLib="base.vcx" BaseClass="image" />

	ADD OBJECT 'Imgbs3' AS imgbs WITH ;
		Height = 22, ;
		Left = 207, ;
		Name = "Imgbs3", ;
		Picture = ..\img\txtbusc3.png, ;
		Top = 1, ;
		Width = 22, ;
		ZOrderSet = 2
		*< END OBJECT: ClassLib="base.vcx" BaseClass="image" />

	ADD OBJECT 'txtFiltro' AS txtbs WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		Height = 19, ;
		Left = 2, ;
		Name = "txtFiltro", ;
		SpecialEffect = 1, ;
		Top = 2, ;
		Width = 204, ;
		ZOrderSet = 3
		*< END OBJECT: ClassLib="base.vcx" BaseClass="textbox" />

ENDDEFINE

DEFINE CLASS ejeform AS commandbutton 
 	*< CLASSDATA: Baseclass="commandbutton" Timestamp="" Scale="Pixels" Uniqueid="" />

	Caption = "Command1"
	Height = 27
	Name = "ejeform"
	Picture = ..\img\hacer.bmp
	PicturePosition = 14
	Width = 84
	
	PROCEDURE Click
		cTempo= This.Parent.Parent.Parent.tempo
		Select (cTempo)
		Cva= Alltrim(&cTempo..nom_tab)
		If !Empty( &cTempo..nom_tab)
			Do Form frm_dtabla With Cva, Alltrim(&cTempo..des_tab)
		Endif
		If !Empty( &cTempo..nom_frm)
			oFrom = Alltrim(&cTempo..nom_frm)
			Do Form &oFrom 
		Endif
		
	ENDPROC

ENDDEFINE

DEFINE CLASS frminicio AS frmbs OF "base.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Imgbs1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Txtbs1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="oleTree" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="oleimg" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Command1" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: cargadatos
		*m: llena_tree
		*m: traeform
		*m: traeperm
		*p: _alias
	*</DefinedPropArrayMethod>

	BorderStyle = 0
	Caption = "Form"
	DoCreate = .T.
	Height = 464
	Left = 0
	Name = "frminicio"
	TitleBar = 0
	Top = 0
	Width = 433
	WindowType = 0
	_alias = .F.

	ADD OBJECT 'Command1' AS commandbutton WITH ;
		Caption = "Command1", ;
		Height = 18, ;
		Left = 316, ;
		Name = "Command1", ;
		SpecialEffect = 1, ;
		Style = 1, ;
		Themes = .T., ;
		Top = 430, ;
		Width = 80
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Imgbs1' AS imgbs WITH ;
		BackStyle = 1, ;
		Height = 492, ;
		Left = -1, ;
		Name = "Imgbs1", ;
		Picture = ..\img\sin título-2_r2_c2.jpg, ;
		Top = -1, ;
		Width = 456, ;
		ZOrderSet = 0
		*< END OBJECT: ClassLib="base.vcx" BaseClass="image" />

	ADD OBJECT 'oleimg' AS olecontrol WITH ;
		Height = 100, ;
		Left = 131, ;
		Name = "oleimg", ;
		Top = 215, ;
		Width = 100
		*< END OBJECT: BaseClass="olecontrol" OLEObject="c:\windows\syswow64\mscomctl.ocx" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7///8EAAAABQAAAAYAAAAHAAAACAAAAAkAAAD+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALA3CGf549MBAwAAAMAMAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3wsAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAD0AAAAAAAAABAAAAAIAAAD+/////v///wUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAACAAAAAhAAAAIgAAACMAAAAkAAAAJQAAACYAAAAnAAAAKAAAACkAAAAqAAAAKwAAACwAAAAtAAAALgAAAC8AAAAwAAAAMQAAADIAAAD+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8jfyQskYXREbFqAMDwKDYoIUM0EggAAADtAwAA7QMAAIB+4eYAAAYAJQAAABAAEADAwMAA//8AAAHvzasAAAUAXAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAACQAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA5MzY4MjY1RS04NUZFLTExZDEtOEJFMy0wMDAwRjg3NTREQTEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACADAAAAEltYWdlSGVpZ2h0AAkAAABJCgAAABAAAAALAAAASW1hZ2VXaWR0aAAJAAAASQoAAAAQAAAAAAAAAAAAAAYAAAD/////BQAAgJzpGAAFAAAAAAAAAAAFAAAAAQAAAGx0AABfAgAA/9j/4AAQSkZJRgABAQEAXwBfAAD/2wBDAAYEBAQFBAYFBQYJBgUGCQsIBgYICwwKCgsKCgwQDAwMDAwMEAwODxAPDgwTExQUExMcGxsbHCAgICAgICAgICD/2wBDAQcHBw0MDRgQEBgaFREVGiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICD/wAARCAAOABADAREAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEEBv/EACUQAAEEAAQGAwAAAAAAAAAAAAQBAgMFBhETIQAHEhQxQRUiI//EABkBAAIDAQAAAAAAAAAAAAAAAAAEAgMFBv/EACkRAAIBAwIEBQUAAAAAAAAAAAECEQMh8BIxBCIyQQAFI1FhUnGBobH/2gAMAwEAAhEDEQA/AKb++tW3Nwxt2T3epiCaEaW6IFTqDMtGjtRq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" />

	ADD OBJECT 'oleTree' AS olecontrol WITH ;
		Height = 410, ;
		Left = 10, ;
		Name = "oleTree", ;
		TabIndex = 1, ;
		Top = 7, ;
		Width = 297, ;
		ZOrderSet = 2
		*< END OBJECT: BaseClass="olecontrol" OLEObject="c:\windows\syswow64\mscomctl.ocx" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7///8EAAAA/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALA3CGf549MBAwAAAAADAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAigAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAI4BAAAAAAAABAAAAAIAAAD+////BQAAAAsAAAAGAAAABwAAAAgAAAAJAAAACgAAAP7////+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+2kEHHiYXREbFqAMDwKDYoIUM0EggAAACyHgAAYCoAALE8wWoBAAYAIgAAAAUAAAARAgAADgAAABnXPAAB782rXAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAACQAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA5MzY4MjY1RS04NUZFLTExZDEtOEJFMy0wMDAwRjg3NTREQTEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACADgAAAEhpZGVTZWxlY3Rpb24ABQAAAEwAAAAADAAAAEluZGVudGF0aW9uABEAAABODQAAAAcAAAAAAAAAAAAFAOjYPAAnKAAAAAAAAAUAAIBY6RgAAQAAAFwAH97svQEABQCd6RgAA1LjC5GPzhGd4wCqAEu4UQEAAACQAQAANEAKAAAATGFiZWxFZGl0AAkAAABJCgAAAAAAAAAKAAAATElORVNUWUxFAAkAAABJCgAAAAEAAAANAAAATW91c2VQb2ludGVyAAkAAABJCgAAAAQAAAAOAAAAUGF0aFNlcGFyYXRvcgAKAAAASAAAAAABAAAAXAYAAABTdHlsZQAJAAAASQoAAAABAAAADAAAAE9MRURyYWdNb2RlAAkAAABJCgAAAAEAAAAMAAAAT0xFRHJvcE1vZGUACQAAAEkKAAAAAQAAAAsAAABBcHBlYXJhbmNlAAkAAABJCgAAAAEAAAAMAAAAQm9yZGVyU3R5bGUACQAAAEkKAAAAAQAAAAsAAABDaGVja2JveGVzAAUAAABMAAAAAA4AAABGdWxsUm93U2VsZWN0AAUAAABMAQAAAAwAAABIb3RUcmFja2luZwAFAAAATAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJBfAQAFQXJpYWwgVW5pY29kZSBNUwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" />

	ADD OBJECT 'Txtbs1' AS txtbs WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		Height = 23, ;
		Left = 24, ;
		Name = "Txtbs1", ;
		SpecialEffect = 0, ;
		TabIndex = 2, ;
		Top = 429, ;
		Width = 242, ;
		ZOrderSet = 1
		*< END OBJECT: ClassLib="base.vcx" BaseClass="textbox" />
	
	PROCEDURE cargadatos
		 If !Type("this.objOpciones")= "O"
			This.AddObject("objOpciones", "m_opciones")
		Endif
		This.objOpciones.select_all()
		cCurOPcion = This.objOpciones.getalias()
		
		This.cerrartab("t_OPcion")
		
		Select * From (cCurOPcion) Where !Isnull(Pad_Opc) And !Empty(frm_Opc) Into Cursor T_OPcion
		
		This.cerrartab(cCurOPcion)
		
	ENDPROC

	PROCEDURE Destroy
		this.cerrartab(this.cCursorRe)
		
	ENDPROC

	PROCEDURE Init
		LPARAMETERS cAlias, ntop , nleft   
		this.AddProperty("cCursorRe", cAlias )
		this._alias = this.cCursorRe
		this.Top =nTop 
		this.Left = nLeft 
		*This.oleTree.Style = 1
		This.oleTree.ImageList= This.oleimg.oBJECT
		this.llena_tree()
	ENDPROC

	PROCEDURE llena_tree
		WITH this
			.oletree.Object.Nodes.Clear 
			SELECT (this._alias)
			WITH This.oleTree.Nodes
				scan
					.add(Allt(itemp),4,;
					ALLTRIM(item), ALLTRIM(des_item), img)
				endscan	
			ENDWITH
			For XVAR = 1 To .oleTree.Object.Nodes.Count()
				.oleTree.Nodes(XVAR ).Expanded=.T.
			NEXT
			
			ThisForm.cerrartab((this._alias))
		ENDWITH
	ENDPROC

	PROCEDURE traeform
		nValor = Int(Val(Substr(This.oleTree.Object.SelectedItem.Key,2)))
		
		If !Type("this.objOpciones") = "O"
			This.AddObject("objOpciones", "m_opciones")
		Endif
		This.objOpciones.nCdgOpc = nValor
		This.objOpciones.Select()
		cCurOPcion = This.objOpciones.getalias()
		cValor = Alltrim(&cCurOPcion..Frm_Opc)
		ThisForm.cerrartab(cCurOPcion)
		Return cValor
		
	ENDPROC

	PROCEDURE traeperm
	ENDPROC

	PROCEDURE Command1.Click
		If Messagebox("¿Esta seguro que desea salir del sistema.?",4+32, "Salir del sistema")= 6
		
			
			If Type("_screen.Lis") = "O"
				_Screen.RemoveObject("Lis")
			ENDIF
			
			Clear Events
			Release All
			CLEAR
			Thisform.Release
		
		Endif
	ENDPROC

	PROCEDURE oleTree.Click
		*** ActiveX Control Event ***
		If This.Object.Nodes.Count()>0
			If This.Object.SelectedItem.Selected()
				cFormulario = This.Parent.TraeForm()
				If !Empty(cFormulario )
					Do Form (cFormulario)
					Thisform.Release()
				Else
				Endif
			Endif
		Endif
		
	ENDPROC

	PROCEDURE oleTree.DblClick
		*** ActiveX Control Event ***
		This.click()
	ENDPROC

	PROCEDURE oleTree.KeyPress
		*** ActiveX Control Event ***
		Lparameters keyascii
		
		
		
		This.click()
		
		If  keyascii= 27
			If Type("_Screen.olist")= "O"
				RELEASE olist
			Endif
		Endif
		
		
		*!*	If Len(Alltrim(cValor))>=9
		*!*	Wait Windows cValor
		*!*	Endif
	ENDPROC

	PROCEDURE oleTree.NodeClick
		*** ActiveX Control Event ***
		LPARAMETERS node
		*This.SELectedItem.Expanded= .T.
	ENDPROC

	PROCEDURE Txtbs1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		If  nKeyCode= 27
			If Type("_Screen.olist")= "O"
				_Screen.RemoveObject("olist")
			Endif
		ENDIF
		
		
	ENDPROC

	PROCEDURE Txtbs1.LostFocus
		If Empty(This.Value)
			This.Parent._alias=  This.Parent.cCursorRe
			This.Parent.llena_tree()
		Else
			cvalor = "%"+Chrtran(Alltrim(This.Value), " ","%")+"%"
			This.Parent.cargadatos()
			Select * From t_opcion Where Des_Opc Like cvalor  Into Cursor ListOpc
		
			tmpo = Sys(2015)
		
			Create Cursor (tmpo) (Item c(9), itemp c(9) Null , des_item c(100) , img i )
		
			Select ListOpc
			Go Top
			Do While !Eof()
				m.item = "_"+Padl(ListOpc.Cdg_Opc,3,'0')
				m.itemp = Null
				m.des_item = Alltrim(ListOpc.Des_Opc)
				m.img = 3
				Insert Into (tmpo) From Memvar
		
				Select ListOpc
				Skip
			Enddo
		
			This.Parent._alias= tmpo
			This.Parent.llena_tree()
			Thisform.cerrartab(tmpo)
		
		
		Endif
		Thisform.cerrartab("t_OPcion")
		Thisform.cerrartab("ListOpc")
		
	ENDPROC

ENDDEFINE

DEFINE CLASS frmmaraca AS cntbs OF "base.vcx" 
 	*< CLASSDATA: Baseclass="container" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Image13" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Image8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Image3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Image9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Image5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Image14" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Image2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Image7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Image4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Image12" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Image1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Image11" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Image6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Image10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Image19" UniqueID="" Timestamp="" />

	BackColor = 248,248,248
	BackStyle = 0
	Height = 376
	Name = "frmmaraca"
	Width = 661

	ADD OBJECT 'Image1' AS image WITH ;
		Height = 30, ;
		Left = 2, ;
		Name = "Image1", ;
		Picture = ..\img\from\from01.png, ;
		Top = 2, ;
		Width = 30
		*< END OBJECT: BaseClass="image" />

	ADD OBJECT 'Image10' AS image WITH ;
		Height = 323, ;
		Left = 629, ;
		Name = "Image10", ;
		Picture = ..\img\from\from11.png, ;
		Stretch = 2, ;
		Top = 27, ;
		Width = 30
		*< END OBJECT: BaseClass="image" />

	ADD OBJECT 'Image11' AS image WITH ;
		Height = 30, ;
		Left = 629, ;
		Name = "Image11", ;
		Picture = ..\img\from\from10.png, ;
		Top = 344, ;
		Width = 30
		*< END OBJECT: BaseClass="image" />

	ADD OBJECT 'Image12' AS image WITH ;
		Height = 30, ;
		Left = 629, ;
		Name = "Image12", ;
		Picture = ..\img\from\from05.png, ;
		Top = 2, ;
		Width = 30
		*< END OBJECT: BaseClass="image" />

	ADD OBJECT 'Image13' AS image WITH ;
		Height = 30, ;
		Left = 254, ;
		Name = "Image13", ;
		Picture = ..\img\from\from09.png, ;
		Stretch = 2, ;
		Top = 344, ;
		Width = 381
		*< END OBJECT: BaseClass="image" />

	ADD OBJECT 'Image14' AS image WITH ;
		Height = 30, ;
		Left = 245, ;
		Name = "Image14", ;
		Picture = ..\img\from\from04.png, ;
		Stretch = 2, ;
		Top = 2, ;
		Width = 385
		*< END OBJECT: BaseClass="image" />

	ADD OBJECT 'Image19' AS image WITH ;
		Height = 17, ;
		Left = 640, ;
		Name = "Image19", ;
		Picture = ..\img\from\cerrar1.png, ;
		Stretch = 0, ;
		Top = 4, ;
		Width = 17
		*< END OBJECT: BaseClass="image" />

	ADD OBJECT 'Image2' AS image WITH ;
		Height = 30, ;
		Left = 31, ;
		Name = "Image2", ;
		Picture = ..\img\from\from02.png, ;
		Stretch = 2, ;
		Top = 2, ;
		Width = 230
		*< END OBJECT: BaseClass="image" />

	ADD OBJECT 'Image3' AS image WITH ;
		Height = 30, ;
		Left = 26, ;
		Name = "Image3", ;
		Picture = ..\img\from\from07.png, ;
		Stretch = 2, ;
		Top = 344, ;
		Width = 233
		*< END OBJECT: BaseClass="image" />

	ADD OBJECT 'Image4' AS image WITH ;
		Height = 30, ;
		Left = 2, ;
		Name = "Image4", ;
		Picture = ..\img\from\from06.png, ;
		Top = 344, ;
		Width = 30
		*< END OBJECT: BaseClass="image" />

	ADD OBJECT 'Image5' AS image WITH ;
		Height = 318, ;
		Left = 2, ;
		Name = "Image5", ;
		Picture = ..\img\from\from13.png, ;
		Stretch = 2, ;
		Top = 32, ;
		Width = 30
		*< END OBJECT: BaseClass="image" />

	ADD OBJECT 'Image6' AS image WITH ;
		Height = 2, ;
		Left = 38, ;
		Name = "Image6", ;
		Picture = ..\img\from\from14.png, ;
		Stretch = 2, ;
		Top = 38, ;
		Width = 2
		*< END OBJECT: BaseClass="image" />

	ADD OBJECT 'Image7' AS image WITH ;
		Height = 30, ;
		Left = 246, ;
		Name = "Image7", ;
		Picture = ..\img\from\from03.png, ;
		Top = 2, ;
		Width = 30
		*< END OBJECT: BaseClass="image" />

	ADD OBJECT 'Image8' AS image WITH ;
		Height = 30, ;
		Left = 245, ;
		Name = "Image8", ;
		Picture = ..\img\from\from08.png, ;
		Top = 344, ;
		Width = 30
		*< END OBJECT: BaseClass="image" />

	ADD OBJECT 'Image9' AS image WITH ;
		Height = 323, ;
		Left = 245, ;
		Name = "Image9", ;
		Picture = ..\img\from\from12.png, ;
		Stretch = 2, ;
		Top = 27, ;
		Width = 30
		*< END OBJECT: BaseClass="image" />
	
	PROCEDURE Image19.Click
		THISFORM.Release()
	ENDPROC

ENDDEFINE

DEFINE CLASS mantotablas AS container 
 	*< CLASSDATA: Baseclass="container" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="cntTitulo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cntTitulo.txtTitTabla" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cntTitulo.Image1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cntItem" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cntItem.txtDesIten" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cntItem.Image1" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: backstyle_access
	*</DefinedPropArrayMethod>

	Height = 120
	Name = "mantotablas"
	Width = 474

	ADD OBJECT 'cntItem' AS container WITH ;
		BackStyle = 0, ;
		BorderWidth = 0, ;
		Height = 34, ;
		Left = 3, ;
		Name = "cntItem", ;
		Top = 0, ;
		Width = 699
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'cntItem.Image1' AS image WITH ;
		Height = 22, ;
		Left = 47, ;
		Name = "Image1", ;
		Picture = ..\img\document 2 edit.png, ;
		Stretch = 1, ;
		Top = 0, ;
		Width = 17
		*< END OBJECT: BaseClass="image" />

	ADD OBJECT 'cntItem.txtDesIten' AS txtapli WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		Enabled = .F., ;
		FontBold = .T., ;
		Height = 18, ;
		iguarda = S, ;
		Left = 75, ;
		Name = "txtDesIten", ;
		Top = 0, ;
		Width = 345
		*< END OBJECT: ClassLib="aplica.vcx" BaseClass="textbox" />

	ADD OBJECT 'cntTitulo' AS container WITH ;
		BackStyle = 0, ;
		BorderWidth = 0, ;
		Height = 34, ;
		Left = 0, ;
		Name = "cntTitulo", ;
		Top = 0, ;
		Width = 699
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'cntTitulo.Image1' AS image WITH ;
		Height = 22, ;
		Left = 13, ;
		Name = "Image1", ;
		Picture = ..\img\database.png, ;
		Stretch = 1, ;
		Top = 0, ;
		Width = 17
		*< END OBJECT: BaseClass="image" />

	ADD OBJECT 'cntTitulo.txtTitTabla' AS txtapli WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		Enabled = .F., ;
		FontBold = .T., ;
		Height = 19, ;
		iguarda = S, ;
		Left = 41, ;
		Name = "txtTitTabla", ;
		Top = -1, ;
		Width = 402
		*< END OBJECT: ClassLib="aplica.vcx" BaseClass="textbox" />
	
	PROCEDURE backstyle_access
		*To do: Modify this routine for the Access method
		cTempo= This.parent.parent.parent.tempo
		Select (cTempo)
		This.cntTitulo.Visible = .F.
		This.cntItem.Visible = .F.
		If Empty(&cTempo..cdg_tab)
			This.cntTitulo.Visible = .T.
			This.cntTitulo.txtTitTabla.Value = &cTempo..des_mod
		Endif
		If !Empty(&cTempo..cdg_tab)
			This.cntItem.Visible = .T.
			This.cntItem.txtDesIten.Value = &cTempo..des_tab
		Endif
		
		
		Return This.BackStyle
		
	ENDPROC

ENDDEFINE

DEFINE CLASS mninicio AS cntbs OF "base.vcx" 
 	*< CLASSDATA: Baseclass="container" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Imgbs1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Txtbs1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="oleTree" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="oleimg" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Command1" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: cargadatos
		*m: llena_tree
		*m: traeform
		*m: traeperm
		*p: _alias
	*</DefinedPropArrayMethod>

	BackStyle = 0
	BorderWidth = 0
	Height = 464
	Name = "mninicio"
	Width = 433
	_alias = 

	ADD OBJECT 'Command1' AS commandbutton WITH ;
		Caption = "Command1", ;
		Height = 18, ;
		Left = 317, ;
		Name = "Command1", ;
		SpecialEffect = 1, ;
		Style = 1, ;
		Themes = .T., ;
		Top = 431, ;
		Width = 80
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Imgbs1' AS imgbs WITH ;
		BackStyle = 1, ;
		Height = 492, ;
		Left = 0, ;
		Name = "Imgbs1", ;
		Picture = ..\img\sin título-2_r2_c2.jpg, ;
		Top = 0, ;
		Width = 456, ;
		ZOrderSet = 0
		*< END OBJECT: ClassLib="base.vcx" BaseClass="image" />

	ADD OBJECT 'oleimg' AS olecontrol WITH ;
		Height = 100, ;
		Left = 132, ;
		Name = "oleimg", ;
		Top = 216, ;
		Width = 100
		*< END OBJECT: BaseClass="olecontrol" OLEObject="c:\windows\system32\mscomctl.ocx" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7///8EAAAABQAAAAYAAAAHAAAACAAAAAkAAAD+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMCsPAvs9NEBAwAAAMAMAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3wsAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAD0AAAAAAAAABAAAAAIAAAD+/////v///wUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAACAAAAAhAAAAIgAAACMAAAAkAAAAJQAAACYAAAAnAAAAKAAAACkAAAAqAAAAKwAAACwAAAAtAAAALgAAAC8AAAAwAAAAMQAAADIAAAD+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8jfyQskYXREbFqAMDwKDYoIUM0EggAAADtAwAA7QMAAIB+4eYAAAYAJQAAABAAEADAwMAA//8AAAHvzasAAAUAXAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAACQAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA5MzY4MjY1RS04NUZFLTExZDEtOEJFMy0wMDAwRjg3NTREQTEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACADAAAAEltYWdlSGVpZ2h0AAkAAABJCgAAABAAAAALAAAASW1hZ2VXaWR0aAAJAAAASQoAAAAQAAAAAAAAAAAAAAYAAAD/////BQAAgAAAAAAFAAAAAAAAAAAFAAAAAQAAAGx0AABfAgAA/9j/4AAQSkZJRgABAQEAXwBfAAD/2wBDAAYEBAQFBAYFBQYJBgUGCQsIBgYICwwKCgsKCgwQDAwMDAwMEAwODxAPDgwTExQUExMcGxsbHCAgICAgICAgICD/2wBDAQcHBw0MDRgQEBgaFREVGiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICD/wAARCAAOABADAREAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEEBv/EACUQAAEEAAQGAwAAAAAAAAAAAAQBAgMFBhETIQAHEhQxQRUiI//EABkBAAIDAQAAAAAAAAAAAAAAAAAEAgMFBv/EACkRAAIBAwIEBQUAAAAAAAAAAAECEQMh8BIxBCIyQQAFI1FhUnGBobH/2gAMAwEAAhEDEQA/AKb++tW3Nwxt2T3epiCaEaW6IFTqDMtGjtRq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" />

	ADD OBJECT 'oleTree' AS olecontrol WITH ;
		Height = 226, ;
		Left = 10, ;
		Name = "oleTree", ;
		TabIndex = 1, ;
		Top = 192, ;
		Width = 297, ;
		ZOrderSet = 2
		*< END OBJECT: BaseClass="olecontrol" OLEObject="c:\windows\system32\mscomctl.ocx" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7///8EAAAA/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMCsPAvs9NEBAwAAAAADAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlQAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAI4BAAAAAAAABAAAAAIAAAD+////BQAAAAsAAAAGAAAABwAAAAgAAAAJAAAACgAAAP7////+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+2kEHHiYXREbFqAMDwKDYoIUM0EggAAACyHgAAXBcAALE8wWoBAAYAIgAAAAUAAAARAgAADgAAAAEAAAAB782rXAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAACQAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA5MzY4MjY1RS04NUZFLTExZDEtOEJFMy0wMDAwRjg3NTREQTEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACADgAAAEhpZGVTZWxlY3Rpb24ABQAAAEwAAAAADAAAAEluZGVudGF0aW9uABEAAABODQAAAAcAAAAAAAAAAAAFAKAeMgAnKAAAAAAAAAUAAIBg6RIAAQAAAFwAH97svQEABQCp6RIAA1LjC5GPzhGd4wCqAEu4UQEAAACQAQAANEAKAAAATGFiZWxFZGl0AAkAAABJCgAAAAAAAAAKAAAATGluZVN0eWxlAAkAAABJCgAAAAEAAAANAAAATW91c2VQb2ludGVyAAkAAABJCgAAAAQAAAAOAAAAUGF0aFNlcGFyYXRvcgAKAAAASAAAAAABAAAAXAYAAABTdHlsZQAJAAAASQoAAAABAAAADAAAAE9MRURyYWdNb2RlAAkAAABJCgAAAAEAAAAMAAAAT0xFRHJvcE1vZGUACQAAAEkKAAAAAQAAAAsAAABBcHBlYXJhbmNlAAkAAABJCgAAAAEAAAAMAAAAQm9yZGVyU3R5bGUACQAAAEkKAAAAAQAAAAsAAABDaGVja2JveGVzAAUAAABMAAAAAA4AAABGdWxsUm93U2VsZWN0AAUAAABMAQAAAAwAAABIb3RUcmFja2luZwAFAAAATAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJBfAQAQQXJpYWwgVW5pY29kZSBNUwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" />

	ADD OBJECT 'Txtbs1' AS txtbs WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		Height = 23, ;
		Left = 25, ;
		Name = "Txtbs1", ;
		SpecialEffect = 0, ;
		TabIndex = 2, ;
		Top = 430, ;
		Width = 242, ;
		ZOrderSet = 1
		*< END OBJECT: ClassLib="base.vcx" BaseClass="textbox" />
	
	PROCEDURE cargadatos
		 If !Type("this.objOpciones")= "O"
			This.AddObject("objOpciones", "Opciones")
		Endif
		This.objOpciones.select_all()
		cCurOPcion = This.objOpciones.getalias()
		
		
		If Used("t_OPcion")
			Use In T_OPcion
		Endif
		
		Select * From (cCurOPcion) Where !Isnull(Pad_Opc) And !Empty(frm_Opc) Into Cursor T_OPcion
		
		If Used(cCurOPcion)
			Use In (cCurOPcion)
		Endif
		
	ENDPROC

	PROCEDURE Init
		LPARAMETERS cAlias 
		this.AddProperty("cCursorRe", cAlias )
		this._alias = this.cCursorRe
		
		*This.oleTree.Style = 1
		This.oleTree.ImageList= This.oleimg.oBJECT
		this.llena_tree()
	ENDPROC

	PROCEDURE llena_tree
		WITH this
			.oletree.Object.Nodes.Clear 
			SELECT (this._alias)
			WITH This.oleTree.Nodes
				scan
					.add(Allt(itemp),4,;
					ALLTRIM(item), ALLTRIM(des_item), img)
				endscan	
			ENDWITH
		*	.oleTree.Nodes(1).Expanded=.T.
		ENDWITH
	ENDPROC

	PROCEDURE traeform
		nValor = Int(Val(Substr(This.oleTree.Object.SelectedItem.Key,2)))
		If !Type("this.objOpciones") = "O"
			This.AddObject("objOpciones", "Opciones")
		Endif
		This.objOpciones.nCdgOpc = nValor
		This.objOpciones.Select()
		cCurOPcion = This.objOpciones.getalias()
		cValor = Alltrim(&cCurOPcion..Frm_Opc)
		If Used(cCurOPcion)
			Use In (cCurOPcion)
		Endif
		Return cValor
		
	ENDPROC

	PROCEDURE traeperm
	ENDPROC

	PROCEDURE Command1.Click
		If Messagebox("¿Esta seguro que desea salir del sistema.?",4+32, "Salir del sistema")= 6
		
			If Type("_Screen.olist")= "O"
				_Screen.RemoveObject("olist")
			Endif
			If Type("_screen.Lis") = "O"
				_Screen.RemoveObject("Lis")
			Endif
			Clear Events
			RELEASE ALL 
			Clear
		
		Endif
	ENDPROC

	PROCEDURE oleTree.Click
		*** ActiveX Control Event ***
		If This.Object.Nodes.Count()>0
			If This.Object.SelectedItem.Selected()
				cFormulario = This.Parent.TraeForm()
				If !Empty(cFormulario )
					Do Form (cFormulario)
					_Screen.RemoveObject("olist")
				Else
				Endif
			Endif
		Endif
		
	ENDPROC

	PROCEDURE oleTree.DblClick
		*** ActiveX Control Event ***
		This.click()
	ENDPROC

	PROCEDURE oleTree.KeyPress
		*** ActiveX Control Event ***
		Lparameters keyascii
		
		
		
		This.click()
		
		If  keyascii= 27
			If Type("_Screen.olist")= "O"
				_Screen.RemoveObject("olist")
			Endif
		Endif
		
		
		*!*	If Len(Alltrim(cValor))>=9
		*!*	Wait Windows cValor
		*!*	Endif
	ENDPROC

	PROCEDURE oleTree.StartLabelEdit
		*** ActiveX Control Method ***
		
	ENDPROC

	PROCEDURE Txtbs1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		If  nKeyCode= 27
			If Type("_Screen.olist")= "O"
				_Screen.RemoveObject("olist")
			Endif
		ENDIF
		
		
	ENDPROC

	PROCEDURE Txtbs1.LostFocus
		If Empty(This.Value)
			This.Parent._alias=  This.parent.cCursorRe
			This.Parent.llena_tree()
		Else
			cvalor = "%"+Chrtran(ALLTRIM(This.Value), " ","%")+"%"
			This.Parent.cargadatos()
			Select * From t_opcion Where Des_Opc Like cvalor  Into Cursor ListOpc
		
			tmpo = Sys(2015)
		
			Create Cursor (tmpo) (Item c(9), itemp c(9) Null , des_item c(100) , img i )
		
			Select ListOpc
			Go Top
			Do While !Eof()
				m.item = "_"+Padl(ListOpc.Cdg_Opc,3,'0')
				m.itemp = null
				m.des_item = Alltrim(ListOpc.Des_Opc)
				m.img = 3
				Insert Into (tmpo) From Memvar
		
				Select ListOpc
				Skip
			Enddo
		
			This.Parent._alias= tmpo
			This.Parent.llena_tree()
		
			If Used(tmpo )
				Use In (tmpo )
			Endif
		
		
		Endif
		If Used("t_OPcion")
			Use In t_opcion
		ENDIF
		If Used("ListOpc")
			Use In ListOpc
		Endif
		
	ENDPROC

ENDDEFINE

DEFINE CLASS txt AS cntbs OF "base.vcx" 
 	*< CLASSDATA: Baseclass="container" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Image1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Image2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Image3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="bstxt1" UniqueID="" Timestamp="" />

	BackStyle = 0
	BorderWidth = 0
	Height = 30
	Name = "txt"
	SpecialEffect = 1
	Width = 135

	ADD OBJECT 'bstxt1' AS txtbs WITH ;
		BackColor = 238,238,238, ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		Height = 20, ;
		Left = 18, ;
		Name = "bstxt1", ;
		Top = 5, ;
		Width = 101, ;
		ZOrderSet = 3
		*< END OBJECT: ClassLib="base.vcx" BaseClass="textbox" />

	ADD OBJECT 'Image1' AS image WITH ;
		Anchor = 240, ;
		BackStyle = 0, ;
		Height = 28, ;
		Left = 2, ;
		Name = "Image1", ;
		Picture = ..\img\txt1.png, ;
		Stretch = 1, ;
		Top = 1, ;
		Width = 20, ;
		ZOrderSet = 0
		*< END OBJECT: BaseClass="image" />

	ADD OBJECT 'Image2' AS image WITH ;
		Anchor = 240, ;
		BackStyle = 0, ;
		Height = 28, ;
		Left = 19, ;
		Name = "Image2", ;
		Picture = ..\img\txt2.png, ;
		Stretch = 2, ;
		Top = 1, ;
		Width = 96, ;
		ZOrderSet = 1
		*< END OBJECT: BaseClass="image" />

	ADD OBJECT 'Image3' AS image WITH ;
		Anchor = 240, ;
		BackStyle = 0, ;
		Height = 28, ;
		Left = 111, ;
		Name = "Image3", ;
		Picture = ..\img\txt3.png, ;
		Stretch = 1, ;
		Top = 1, ;
		Width = 22, ;
		ZOrderSet = 2
		*< END OBJECT: BaseClass="image" />

ENDDEFINE
